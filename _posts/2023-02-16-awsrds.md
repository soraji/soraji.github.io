---
layout: post
title: "[ AWS ] RDS로 DB 인스턴스, EC2로 VM 인스턴스 만들기"
categories: back
comments: true
---

<br>

<br>

AWS 배포 2번째.. 역시 일주일 지났는데 새까맣게 다 잊어버렸다.. 휴 ꒰𖦹ˊᯅˋ𖦹꒱

이번에는 하는김에 제대로 기록해보기 ! 

<br>

<br>

<br>

<br>

## RDS 에서 데이터베이스 생성

![aws](/assets/img/aws/aws1.png)

RDS를 검색해서 들어가게 되면 아무것도 없다. 거기서 데이터베이스 생성 버튼을 누른다

<br>

<br>

![aws](/assets/img/aws/aws2.png)

원하는 DB를 선택한다. 나는 MySQL을 쓸거니까 MySQL 선택

<br>

<br>

![aws](/assets/img/aws/aws3.png)

템플릿은 프리티어를 선택한다. 근데 프리티어라고 해서 전부 무료가 아니고, 주어진 이상으로 사용하게 되면 과금되니까 늘 조심조심 해야하고

요금이 일정량을 달성하게 되면 알럿 메일이 오도록 설정해놔야한다..

(AWS는 진짜 번역이 💩이다)

EC2든 RDS든 늘 조심하자.. 아무거나 막 눌러도 과금이 될 확률이 너무 높음.

> 나의 경우는 Redis 설정해놔서 과금
>
> 고정아이피 신청하고 인스턴스 죽여놔서 과금(살아있는 인스턴스 1개만 연결해놓으면 안나온다고 함)
>
> VM인스턴스 2개 이상 만들어서 과금
>
> DB인스턴스 2개 이상 만들어서 과금
>
> 등등... 조심 또 조심하자...

<br>

<br>

![aws](/assets/img/aws/aws4.png)

DB이름을 설정하고,

사용자는 그냥 디폴트가 admin이라 원하는대로 해주면 될듯

마스터 암호도 DB접속을 위해 정해준다. 보통은 root 에 root로 하는데 어려운걸로 해놨다.

<br>

<br>

![aws](/assets/img/aws/aws5.png)

할당된 스토리지가 최솟값이 20인데 잘못적음;;;

20으로 해주면 됨

<br>

<br>

![aws](/assets/img/aws/aws6.png)

퍼블릭 엑세스를 해놓지 않으면 외부에서 접속할 수 없기 때문에 우선은 퍼블릭 엑세스를 `예`로 선택한다

근데 퍼블릭 엑세스로 설정해놓으면 아무나 DB에 접속할 수 있다는 말이므로 원래는 꺼놔야함

<br>

<br>

밑에 VPC는 기본으로 default로 되어있을텐데, 나중에 VM인스턴스까지 만들면 수정해주어야 한다.

우선 지금은 VM인스턴스를 안만들었기 때문에 기본인 default로 해주고 나중에 수정하자.

<br>

<br>

![aws](/assets/img/aws/aws7.png)

데이터베이스 이름을 지정해준다. 

그리고 생성? 만들기? 여튼 버튼을 눌러주면 데이터베이스가 생성된다. (시간이 꽤 걸린다. 한 10분 15분 기다려야하는것 같다)

생성되는 사이에 다른걸 해주자

<br>

<br>

![aws](/assets/img/aws/aws8.png)

RDS 메뉴 밑에 파라미터 그룹이라고 있다.

거기서 파라미터 그룹 생성 버튼을 눌러준다

<br>

<br>

![aws](/assets/img/aws/aws9.png)

그룹이름과 설명을 적어주고 생성 버튼을 누른다.

<br>

<br>

![aws](/assets/img/aws/aws10.png)

생성된 그룹 안으로 들어가서 파라미터에 'character_set' 을 검색하면 8개인가? 해당되는 모든 필드가 나오는데,

그걸 전체 수정해줄거다. 수정해주기 위해서는 파라미터 편집 버튼을 눌러준다

<br>

<br>

![aws](/assets/img/aws/aws11.png)

그러면 값의 셀렉트 버튼이 활성화가 되면서 값을 바꿔줄 수 있는데, 기본값말고 utf8mb4로 바꿔준다 (모두!)

그리고 변경 사항 저장 버튼을 누른다

<br>

<br>

![aws](/assets/img/aws/aws13.png)

이 와중에 데이터베이스 생성이 완료되었다. 생성된 데이터베이스의 라디오버튼을 체크하고 수정버튼을 누른다.

사용가능이라는 상태가 뜨지 않으면 수정버튼이 활성화 되지 않는다

<br>

<br>

![aws](/assets/img/aws/aws14.png)

밑으로 좀 내리다보면 접혀있는 `추가 구성`을 볼 수 있는데, 거기서 방금 수정해준 `파라미터 그룹`으로 바인딩을 변경해준다.

<br>

<br>

![aws](/assets/img/aws/aws15.png)

`다음`으로 넘어가면 `즉시 적용`을 누르고 `DB인스턴스 수정` 을 누른다.

<br>

<br>

## EC2에서 VM인스턴스 생성

![aws](/assets/img/aws/aws16.png)

아무것도 없이 깰꼼한 인스턴스 대시보드... `인스턴스 시작`을 눌러 인스턴스를 생성해보자

<br>

<br>

![aws](/assets/img/aws/aws17.png)

원하는 인스턴스 이름을 적어준다

<br>

<br>

![aws](/assets/img/aws/aws18.png)

OS는 본인이 원하는거 사용하면 되는데, 프리티어로 사용하려면 `프리 티어 사용 가능` 이라고 적힌걸 선택해야한다.

나는 리눅스가 편해서 리눅스, 그리고 인스턴스는 `t2.micro`를 선택했다.

사실 프리티어가 가능한 인스턴스의 옵션이 그렇게 넓지가 않아서 이게 최선이다.

(예를들어 좀이따 하겠지만 t2.micro의 용량이 부족해서 로컬에서 빌드를 하고 올려야한다.)

<br>

<br>

![aws](/assets/img/aws/aws19.png)

엄청 중요한 키 페어!

실제로 내 로컬 터미널에서 AWS VM인스턴스로 접속이 가능하게 해주는 인증서이다.

이름을 적고, `새 키 페어 생성` 을 누른다.

<br>

<br>

![aws](/assets/img/aws/aws20.png)

그러면 새 창이 뜨면서 키 페어를 다운로드 받을 수 있는 창이 새로 뜬다.

잃어버리면 재발급받아야하니까 잘 가지고 있자.

근데  `pem`확장자로 받아야하는데 다운 받을때마다 계속해서 `cer` 확장자로 다운로드 받아지는거다....!!!!

그냥 단순하게 `cer` 확장자를 `pem`으로 바꿔주자. cer는 cli 접속명령어에서 못알아 먹는다...

<br>

>🚫 저장 경로 절대지켜 🚫
>
>저장은 절대 git과 연결되어있는 폴더 안에다가 하지 말자. 
>
>(아무생각없이 연관있는 인증서니까 폴더 안에다가 저장하는 경우가 많은것 같다. 그러지말자.)
>
>git에 올라가면 보안때문에 난리도 아니다. 커밋사항도 다 변경해줘야하고 아주 귀찮아짐..
>
>상위폴더에다가 저장하든지 하자 !!!!!

<br>

<br>

![aws](/assets/img/aws/aws21.png)

스토리지 구성에서 최대 20기가까지 무료인데, 난 뭐 그정도까지 필요없어서 10으로 했다. 

(아까 RDS 스토리지랑 헷갈려서 거기도 10으로 적어줌;;)

그리고 `인스턴스 시작` 버튼을 눌러준다

<br>

<br>

![aws](/assets/img/aws/aws22.png)

그러면 인스턴스가 생성된걸 확인할 수 있다.

보고싶은 인스턴스 앞 체크박스에 체크를 하면 밑에 상세 정보가 뜬다.

그중에 `보안` 탭으로 넘어가면 `보안그룹` 이 뜨는걸 볼 수 있다.

그 보안 그룹을 클릭하면 인바운드 규칙 , 아웃바운드 규칙이라고 뜨는데 거기서 `인바운드 규칙 편집`을 클릭하면

<br>

<br>

![aws](/assets/img/aws/aws23.png)

이렇게 인바운드 규칙을 편집할 수 있게 나온다.

여기서 우선은 (바람직한거 아님! ) 모든 TCP에 대한 접근을 허용해주자. `Anywhere-IPv4`와 `Anywhere-IPv6` 모두!

<br>

<br>

![aws](/assets/img/aws/aws24.png)

아웃바운드 규칙도 동일하게 편집해준다

<br>

<br>



<br>

<br>

<br>

<br>

<br>

<br>

<br>

2편에서 이어집니다 

댓글은 힘과 사랑이에요 (●'ᴗ'●)ﾉ♥
