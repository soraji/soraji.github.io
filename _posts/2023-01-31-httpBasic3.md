---
layout: post
title:  "http 메서드"
subtitle:   ""
categories: web
comments: true
---



<br>

<br>

<br>

URI를 설계할때 가장 중요하게 고민해야하는 것이 리소스이다

API를 설계할때 URI를 어떻게 만들어야할지 고민한다면 가장 중요하게 고민해야하는 것은 리소스이다.

=> 리소스는 어떤 행위가 아니라 개념 자체가 리소스다.

Ex) 회원을 등록하고 수정하고 조회하는게 리소스가 아니라 회원이라는 개념 자체가 리소스임.

그러므로 회원을 등록하고 수정하고 조회하는 것을 모두 배제하고 회원이라는 리소스만 식별하면 됨

(= 회원 리소스를 URI에 매핑)

리소스(`users`)와 해당 리소스를 대상으로 하는 행위(`create-user`)를 분리

<br>

<br>

---

# HTTP 메서드 종류

* GET : 리소스 조회
* POST : 요청 데이터 처리, 주로 등록에 사용
* PUT : 리소스를 대체, 해당 리소스가 없으면 생성
* PATCH : 리소스 부분 변경
* DELETE : 리소스 삭제
* HEAD : get과 동일하지만 메시지 부분을 제외하고, 상태 줄과 헤더만 반환
* OPTIONS : 대상 리소스에 대한 통신 가능 옵션을 설명(주로 cors에서 사용)

<br>

<br>

### GET

* 리소스 조회
* 서버에 전달하고 싶은 데이터는 query(쿼리 파라미터, 쿼리 스트링) 를 통해서 전달
* 메시지 바디를 사용해서 데이터를 전달할 수 있지만, 지원하지 않는 곳이 많아서 권장하지 않음

### POST 

* 새 리소스 생성(등록)
  * 서버가 아직 식별하지 않은 새 리소스 생성
* 요청 데이터 처리
  * 단순히 데이터를 생성하거나, 변경하는 것을 넘어서 프로세스를 처리해야 하는 경우
  * Ex) 주문->결제완료->배달시작->배달완료 처럼 값 변경을 넘어 프로세스의 상태가 변경되는 경우
  * POST의 결과로 새로운 리소스가 생성되지 않을 수도 있음
  * 리소스로 최대한 uri를 설계하되 꼭 필요한 경우에는 동사uri가 생성될 수 있는데 이걸 컨트롤URI라고 부름
* 메시지 바디를 통해 서버로 요청 데이터 전달
* 서버는 요청 데이터를 처리
  * 메시지 바디를 통해 들어온 데이터를 처리하는 모든 기능을 수행한다
* 주로 전달된 데이터로 신규 리소스 등록, 프로세스 처리에 사용
* 다른 메서드로 처리하기 애매한 경우
  * 애매하면 POST 쓰자

### PUT 

* 리소스를 대체

  * 리소스가 있으면 ✨완전히 대체

  ~~~markdown
  /members/create에 
  {
  	"username" : "young",
  	"age" : 20
  }
  
  이라는 데이터가 없으면 새로 입력이 되는데, 만약
  {
  	"age" : 50
  }
  이라는 새로운 데이터가 입력이 되면 username은 날아가 버린다
  수정이 아니라 완전 통째로 덮어쓴다
  ~~~

  * 리소스가 없으면 생성

* 🌟 클라이언트가 리소스를 식별할 수 있어야 함

  * post에서는 어떤 uri에 등록이 될지 알 수 없다
  * put에서는 정확하게 구체적인 uri 전체경로를 안다

### PATCH 

* 리소스 부분 변경

  ~~~markdown
  /members/create에 
  {
  	"username" : "young",
  	"age" : 20
  }
  이라는 데이터가 이미 존재하는 상황에서
  {
  	"age" : 50
  }
  이라는 새로운 데이터가 입력이 되면 age만 변경된다. username은 보존
  ~~~

  

### DELETE 

* 리소스 제거

<br>

<br>

<br>

<br>

---

# HTTP 메서드의 속성

* 안전

  * 호출해도 리소스를 변경하지 않는다
  * '안전'은 해당 리소스만 고려하지 에러가 발생하는지 아닌지를 고려하지 않는다.
  * 조회를 제외한 모든 메서드들이 사실 데이터가 변경되는것이므로 '안전'한것이 아니다

* 멱등 Idempotent ((‘◇’)?.....? 첨들어봄....)

  * 한 번 호출하든 두 번 호출하든 x번을 호출하든 결과가 똑같다

  * GET, PUT, DELETE 는 멱등 메서드이지만 POST는 멱등메서드가 아니다.(결제요청을 몇번이고 하면 이건 에러다...!)

  * 이런개념이 왜 필요할까? 언제 사용할까? => 자동 복구 메커니즘을 사용할때 이용함

  * 서버가 TIMEOUT 등으로 정상 응답을 주지 못했을때 클라이언트가 같은 요청을 다시 해도 괜찮은가? 의 판단 근거가 됨

  * 멱등은 외부요인으로 중간에 리소스가 변경되는 것 까지는 고려하지 않는다. 

    동일한 요청을 나만 요청했을때 바뀌지 않는것을 기준으로 한다.

* 캐시가능(Cacheable)

  * 응답 결과 리소스를 캐시해서 사용해도 되는가?
  * GET, HEAD, POST, PATCH 캐시가능
  * 실제로는 GET, HEAD정도만 캐시로 사용
    * POST, PATCH는 본문 내용까지 고려해야하기때문에 보통은 GET만 캐시로 사용함

<br>

<br>

<br>

<br>

<br>







